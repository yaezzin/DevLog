# Spring Cloud Bus

## Spring Cloud의 Configuration을 변경하는 방법

### 1. 서버 재기동 (외부 구성 서버)

단순히 application.yml에서 값들을 변경하고, 서버를 재기동 하는 방법
* Spring Cloud Config 서버를 사용하여 애플리케이션의 구성 값을 중앙에서 관리하고 동적으로 변경할 수 있음
* 구성 서버는 애플리케이션의 구성 파일을 저장하고 애플리케이션이 실행될 때마다 해당 구성 파일을 제공

### 2. Actuator Refresh
* Spring Boot 애플리케이션은 @RefreshScope 어노테이션을 사용하여 런타임에 구성을 다시 로드할 수 있음 
* 이를 위해 Actuator의 /refresh 엔드포인트를 호출하면 구성이 갱신됨
  * 하지만 각각의 모든 마이크로서비스가 /refresh를 호출해야만 갱신된다는 단점 존재! 
* Actuator Refresh 방식은 애플리케이션을 다시 시작하지 않고도 구성을 업데이트할 수 있는 장점이 있지만, 모든 구성 항목이 동적으로 변경되지는 않음 
  * 일부 구성 항목은 애플리케이션 시작 시에만 로드되기 때문에 변경된 값이 적용되지 않을 수 있음 

### 3. Spring Cloud Bus

분산 시스템에서 구성 업데이트 및 상태 변경을 효율적으로 관리하기 위한 기능을 제공
* 분산 시스템의 노드를 ```메시지 큐 브로커```(ex. Rabbit MQ)와 연결하고, 상태 및 구성에 대한 변경사항을 연결된 노드에게 전달함으로써 분산 시스템간의 통신을 가능케함
* 이를 통해 구성 변경의 실시간 전파, 분산 시스템의 상태 모니터링, 이벤트 기반의 동적인 상호 작용 등을 구현할 수 있음

#### 3-1. 메세징 큐 방식

중앙화된 큐 또는 브로커를 통해 메시지를 보내고 받는 방식
* 생산자(Producer)가 메시지를 큐에 전송하면, 큐는 메시지를 안전하게 보관하고, 소비자(Consumer)가 메시지를 가져와 처리
* 생산자와 소비자는 동기 또는 비동기적으로 통신할 수 있으며, 메시지는 일반적으로 큐에 보관되어 기다리는 동안 소비자가 사용 가능할 때까지 대기
* 여러 소비자가 하나의 큐에서 메시지를 받을 수 있으며, 일반적으로 메시지를 동시에 여러 소비자에게 복제하여 병렬 처리를 지원

#### 3-2. P2P 방식

직접적인 통신 경로를 가지고 있는 피어(프로세스 또는 시스템) 간에 메시지를 교환하는 방식
* 직접적인 연결을 통해 메시지를 교환하며 일반적으로 동기적인 방식으로 이루어짐
* 메시지는 특정 피어에게 직접 전달되며, 다른 피어는 해당 메시지를 수신하지 않음
