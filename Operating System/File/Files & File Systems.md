# 파일 & 파일 시스템

* [FILES & FILE SYSTEMS: CRASH COURSE COMPUTER SCIENCE #20](https://thecrashcourse.com/courses/files-file-systems-crash-course-computer-science-20/)

## 파일 형식

### 1. TXT 

> 텍스트 데이터를 저장하는 데 사용되는 파일 형식

* TXT 파일의 원시값은 2진수로 저장된 긴 숫자 목록으로 구성
* 이 숫자 목록들을 텍스트로 보기 위해서 TXT파일은 문자 인코딩 표준인 **아스키 코드**를 사용하여 디코딩
* 아스키 코드는 컴퓨터에서 문자를 나타내기 위해 사용되는 문자 인코딩 체계로, 각 문자에 해당하는 숫자를 할당하여 저장

### 2. WAV 

> 소리를 저장하고 재생하기 위한 디지털 오디오 형식

* WAV 파일은 **오디오 데이터**와 함께 **메타데이터**를 포함하고 있으며, 이 메타데이터는 ```헤더```라고 불리는 부분에 저장됨
* WAV 파일을 올바르게 읽고 해석하기 위해서는 **비트전송률(bitrate)** 과 **채널 정보(단일 트랙인지 스테레오인지)** 등의 메타데이터 정보가 필요
  * 이러한 메타데이터는 실제 오디오 데이터보다 파일의 앞부분에 저장되어 있으며, 읽어들인 후에 오디오 데이터를 정확하게 해석할 수 있는 정보를 제공
* 실제 오디오 데이터는 메타데이터 바로 뒤에 위치하며, 일련의 숫자 목록으로 구성됨
  * 이 데이터는 오디오 신호의 진폭을 나타내는 숫자로 구성되어 있으며, WAV 파일은 소리의 압력을 샘플링하여 각각의 샘플을 숫자로 표현
  * 숫자의 크기는 진폭의 레벨을 나타내며, 숫자가 클수록 진폭이 더 높은 소리를 의미함
* WAV 파일은 오디오 프로그램이 컴퓨터의 스피커를 작동시켜 오디오 파형을 재생하는 방식으로 동작
  * 파일이 재생되면 오디오 프로그램은 숫자 목록을 읽어 원래의 소리 파형을 재현하여 소리가 출력되도록 함

### 3. BMPS 

> 사진을 저장하는 파일 형식

* 컴퓨터에서 사진은 ```픽셀```이라는 작은 사각형으로 구성되며, 각 픽셀은 빨강(R), 초록(G), 파랑(B) 세가지 색상으로 조합됨
* 이 세 가지 색상 값을 조합하여 다양한 색상과 그라디언트를 나타낼 수 있음
* BMP는 메타데이터 안에 이미지의 너비, 높이, 색상의 심도와 같은 키 값을 포함함
  * 이러한 메타데이터는 이미지의 속성을 설명하고 이미지를 올바르게 해석하기 위해 필요한 정보를 제공
  * 또한, 메타데이터의 마지막 부분에는 ```Color depth```라는 정보가 있는데, 이 값은 각 픽셀의 색상을 나타내기 위해 사용되는 비트 수를 나타내며, 일반적으로 24비트로 표현됨
* 컬러 값이 (255, 255, 255)인 경우에는 픽셀이 흰색을 나타내고, (0, 0, 0)인 경우에는 검정색을 나타냄
  * 이렇게 BMP 파일은 픽셀의 컬러 값을 숫자로 표현하여 이미지를 저장하고 표현

#### 결론 ) 파일 형식은 모두 동일하게 2진수로 저장된 긴 숫자 목록이라는 것!

## 파일 시스템 

### 📍 과거 

컴퓨터가 테이블 계산만 수행했던 초기에는 전체 저장장치가 하나의 큰 파일처럼 작동  
→ 데이터는 저장 장치의 처음부터 시작하여 출력이 생긴 순서대로 최대 저장 용량까지 채워짐  
→ 하지만 계산 능력 + 저장 용량이 향상됨에 따라 한번에 둘 이상의 파일 저장할 수 있게 됨    
→ 이때, 가장 간단한 방법은 **파일을 연속적으로 저장**하는 것  
→ 하지만 이 방법은 컴퓨터가 **파일의 시작과 끝의 위치**를 알 수 있도록 파일이 있는 위치를 기록하는 또다른 파일이 있어야 함  
→ 이를 위해 ```Directory File```을 만들고, 저장공간의 앞쪽에 보관하여 **액세스할 위치**를 항상 알수 있도록 함  
→ 디렉터리 파일에 생성시간, 수정시간, 소유자, 읽기/쓰기 가능여부와 같은 메타 데이터와 함께 파일이 시작되는 위치와 길이를 담음   

### 📍 단일 파일 시스템 

만약 파일을 추가, 제거, 이름 변경 등의 작업을 수행할 때는 디렉터리 파일 정보를 업데이트해야 함
* 디렉터리 파일을 업데이트하지 않으면 파일 정보가 일치하지 않음
* 디렉터리 파일의 유지는 저장된 파일을 관리하고 파악하는 데에 운영체제의 매우 기본적인 파일 시스템의 예시!
* 이러한 구조는 모두 하나의 레벨에 저장되기 때문에 ```단층 파일 체계```라고 함

### 📍 현재 파일 시스템

파일을 서로 맞닿게 묶어서 저장하는 것은 데이터를 추가할 때 문제가 생김  
예를들어 todo.txt 데이터를 추가한다면 carrie.bmp의 일부를 덮어쓰지 않고서는 공간이 없음!!
따라서 현대 파일 시스템은 두가지 방식을 도입하였다.

#### 1. 파일을 블록단위로 저장

- 파일을 블록단위로 저장하면 변경 사항을 위한 여유공간이 생성됨
- 또한 모든 파일데이터가 공통 크기로 정렬되므로 관리가 간단
- 이런 구조에서는 디렉터리 파일은 각 블록이 어디에 저장되어있는지를 기록해두어야함

#### 2. 파일을 블록단위로 저장하고, 여러 블록에 저장되는 것을 허용

- 만약 파일에 추가되어서, 하나의 블록에 저장하기에 크기가 커지게 되면 이웃한 파일에 덮어쓰지 않도록 여분의 데이터를 수용할 수 있는 사용되지 않는 새로운 블록을 할당함
- 따라서 파일시스템은 파일당 하나의 블록이 아닌 파일당 블록 목록을 기록함
- 이런 방식으로 블록을 할당하고, 할당을 해제함으로써 확장 및 수축할 수 있는 가변 크기의 파일을 가질 수 있음
- 삭제의 경우에는 실제 데이터를 삭제하지 않고 기록만 삭제 후 새로운 데이터로 덮어 쓰여질 때까지 데이터를 그 블록에 그냥 냅둠 → 이러한 방식으로 데이터 복구를 가능케함

## 조각화, 조각모음

파일 시스템에서 파일들은 여러 블록에 나누어져 분리된 공간에 저장되는데, 파일이 저장 공간 전반에 걸쳐서 분산되어 저장되는 경우 이를 ```조각화```라고 함
* 조각화는 파일의 블록들이 불연속적으로 저장되어 있어서 파일을 읽거나 쓸 때 디스크 헤드가 여러 위치로 이동해야 함
* 따라서 파일 액세스 성능을 저하시키고 디스크 작업 시간을 증가시킬 수 있음

조각화를 해결하기 위해 ```조각 모음```이 사용됨
* 조각 모음은 데이터를 복사하여 저장소에 있는 파일 블록들을 **올바른 순서대로 함께 배치하여** 파일의 블록들이 연속적으로 저장되도록 조정함
* 이렇게 조각 모음이 수행되면 파일 액세스 시에 디스크 헤드의 이동이 최소화되어 성능 향상이 되고, 파일 시스템의 유틸리티나 운영체제에서 주기적으로 수행되는 작업으로 사용자가 직접 조각 모음을 실행할 필요는 없음

## 계층 파일 시스템

저장장치의 용량이 폭발적으로 증가하면서 파일의 수도 증가하였고, 따라서 모든 파일을 한 수준에 함께 저장하는 것은 비효율적 → 계층 파일 시스템 등장
- 가장 큰 변화는 디렉터리 파일이 파일뿐만 아니라 다른 디렉터리도 가리킬수 있다는 점 → 파일과 디렉터리의 구조를 계층적으로 구성하는 것을 가능케함
- 디렉터리는 파일과 다른 하위 디렉터리를 포함하고 있으며, 파일과 디렉터리를 구분하기 위해 추가적인 메타데이터가 디렉터리에 필요하게 됨
- 루트 디렉터리는 파일 시스템의 가장 상위 디렉터리를 의미하며, 다른 모든 파일과 폴더는 루트 디렉터리 아래에 다양한 파일 경로를 따라 위치함
이렇게 계층적인 구조를 갖는 파일 시스템은 파일 및 디렉터리의 조직화와 탐색을 용이하게 함

## 파일 시스템 이점?

파일시스템을 사용하면 자기테이프, 스피닝 디스크 등에 있는 원시 비트를 숨길 수 있음
- 이를 통해 데이터가 깔끔 + 쉽게 접근할 수 있도록 함
